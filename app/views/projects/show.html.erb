<h1><%= @project.name %></h1>

<div class="container">
	<div>Project name: <%= @project.name %></div>
	<div>Project description: <%= @project.description %></div>
	<div>Project owner: <%=@project_owner.name%></div>
	<div>
		<ul>Project members
			<% @project.users.each_with_index do |user,index| %>
			<li> <%= user.name %>
				<% if current_user != user && @project.completed == true%>
					<%= link_to "Review!", new_response_path(user_id: user.id, project_id: @project.id) %>
				<% end %>
			</li>
			<% end %>
		</ul>
		<% if current_user == @project_owner && @project.completed == false%>
			<div id="project-complete">Complete project
				<%= form_tag complete_project_path, :method => :post do %>
					<input type="hidden" value="<%=@project.id%>" name="project_id">
					<%= submit_tag "Complete project" %>
				<% end %>
			</div>

			<div>Add members
				<%= form_tag add_users_path, :method => :post do %>
					<input type="hidden" value="<%=@project.id%>" name="project_id">
					<%= select_tag 'user_id', options_for_select(@users.collect{ |u| [u.name, u.id] }) %>
 					<%= submit_tag "Add members" %>
 				<% end %>

				<%= link_to "Edit Project", edit_project_path(@project.id) %>
				<%= link_to "Delete Project", project_path(@project.id), method: :delete %>
			</div>
		<% end %>
	</div>

	<% if @project.completed == false %>
		<p>Deadline: <%= @project.deadline %></p>
		<% else %>
		<p>Project Completed!</p>
	<% end %>
</div>

<script type="text/javascript">
	$("#project-complete").click(function(){
    	$.ajax({
    		type: 'PATCH',
    		url: '/projects'
    	})
});
</script>